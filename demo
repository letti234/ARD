//Create demo data//////////////////////////////////////

var region = ee.Geometry.Rectangle(-120, 34.669, -99.536, 50.064);

// Create 10 random points in the region.
var randomPoints = ee.FeatureCollection.randomPoints(region, 1000);

//Produce 10 km buffers, these are the polygons we want to dissolve
var bufferPoly = function(feature) {
  return feature.buffer(10000); 
};

var buffers = randomPoints.map(bufferPoly);
Map.addLayer(buffers, {}, 'buffers');
//print(buffers.limit(10), "Overlapping buffers"); //Each buffer has its own ID but some overlap!




//Dissolve attempt 1: union//////////////////////////////////////

var buffsUnion = buffers.union();
print(buffsUnion, "Dissolve using union fnctn."); //Only contains one feature!
Map.addLayer(buffsUnion, {}, 'Dissolve using union fnctn.');



//Dissolve attempt 1: geometry(),dissolve() //////////////////////////////////////

var buffsGeoDissolve =buffers.geometry().dissolve();
print(buffsGeoDissolve, "Dissolve using geometry().dissolve()"); //Multipolygon!
Map.addLayer(buffsGeoDissolve, {}, 'Dissolve using geometry().dissolve()');








var fc = ee.FeatureCollection([
  ee.Feature(buffsGeoDissolve)
]);
print(fc);

// Make feature collection a list and map over the elements (features)
var multiGeomExplodeList = fc.toList(fc.size()).map(function(feature) {
  // Cast the input as a feature since it is coming from a list, get its
  // geometry, then split geometries into a list.
  var geomList = ee.Feature(feature).geometry().geometries();
  // Map over the geometry list.
  var featureList = geomList.map(function(geom) {
    // Return a feature representation of the geometry.
    return ee.Feature(ee.Geometry(geom));
  });
  // Return a list of all the features making up a potential multi-geometry,
  // this is a list. 
  return featureList;
})
// The result is a list of feature lists - flatten to a single list of features.
.flatten();

// Convert the list of features to a featureCollection.
var multiGeomExplodeFc = ee.FeatureCollection(multiGeomExplodeList);
print(multiGeomExplodeFc);
Map.addLayer(multiGeomExplodeFc);
